#!/bin/bash

APP_PATH=<%= node['spray']['path'] + '/' + node['spray']['app']['name'] =%>

SCRIPT="<%= 'bin/' + node['spray']['app']['name'] =%>"

OPTION="<%= node['spray']['java']['option'] =%>"

USER=root

cd ${APP_PATH}

do_start() {
    exec ${APP_PATH}/${SCRIPT} ${OPTION} &
}

do_stop() {
    pid=`ps aux | grep <%= node['spray']['app']['name'] =%> | grep -v 'grep' | awk '{print $2}'`
    if [[ -n "$pid" ]]; then
        kill -9 $pid
    fi
}


case $1 in
    start)
        do_start
        ;;
    stop)
        do_stop
        ;;
    restart)
        do_stop
        do_start
        ;;
esac
exit 0